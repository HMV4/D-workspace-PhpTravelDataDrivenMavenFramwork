package com.automationinfotech.mainscript;

import java.io.IOException;
import java.lang.reflect.Method;
import java.lang.Class;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

import com.automationinfotech.genericlib.ExcelUtility;
import com.automationinfotech.genericlib.ReportUtility;

public class DriverScript {
	public static String testDataID = "";
	static WebDriver driver;

	public static void main(String[] args) throws IOException {

		ExcelUtility.setWorkBook();
		ReportUtility.createHeader();
		driver = new FirefoxDriver();
		ExcelUtility.setWorkSheet("TestFlow");
		int testFlowRowCnt = ExcelUtility.getRowCount();
		for (int testFlowItt = 1; testFlowItt <= testFlowRowCnt; testFlowItt++) {
			ExcelUtility.setWorkSheet("TestFlow");
			ExcelUtility.setRow(testFlowItt);
			String TestCaseName = ExcelUtility.getCellData("TestCaseName");
			String ExecutionFlag = ExcelUtility.getCellData("ExecutionFlag");
			System.out.println(TestCaseName + ExecutionFlag);
			if (ExecutionFlag.equalsIgnoreCase("Y"))
				ExecuteTestCase(TestCaseName);
		}
	}

	public static void ExecuteTestCase(String TestCaseName) {
		ExcelUtility.setWorkSheet(TestCaseName);
		int TestCaseRowCnt = ExcelUtility.getRowCount();

		for (int i = 1; i <= TestCaseRowCnt; i++) {
			ExcelUtility.setWorkSheet(TestCaseName);
			ExcelUtility.setRow(i);
			String className = ExcelUtility.getCellData("PageName");
			String methodName = ExcelUtility.getCellData("StepName");
			testDataID = ExcelUtility.getCellData("TestDataID");
			String packageName = "com.automationinfotech.applicaitonspecificlib";
			System.out.println(className + methodName);
			try {

				Class c = Class.forName(packageName + "." + className);
				Object obj = c.newInstance();

				Method[] m = c.getMethods();
				for (Method method : m) {
					if (method.getName().equalsIgnoreCase(methodName))
						method.invoke(obj, driver);
				}
			} catch (Exception e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}
	}

}
