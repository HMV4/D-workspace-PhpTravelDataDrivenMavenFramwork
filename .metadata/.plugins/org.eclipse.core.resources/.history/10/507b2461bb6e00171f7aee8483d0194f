package com.automationinfotech.applicaitonspecificlib;

import java.io.IOException;
import java.util.concurrent.TimeUnit;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

import com.automationinfotech.genericlib.ExcelUtility;
import com.automationinfotech.genericlib.GenericUtility;
import com.automationinfotech.genericlib.ReportUtility;
import com.automationinfotech.mainscript.DriverScript;

public class HomePage {
	public void launch(WebDriver driver) throws IOException
	{
		String url=GenericUtility.getEnvionmentValue("URL");
		//driver.get(url);

		if(driver.getTitle().equalsIgnoreCase("Welcome: Mercury Tours"))
			ReportUtility.insertStep("1", "Launch", "Application has been successfully launchded", "Passed");
		else
			ReportUtility.insertStep("1", "Launch", "Application Title is not matched, expected title='Welcome: Mercury Tours' whereas actual is"+ driver.getTitle(), "Failed");
	}

	public void signin(WebDriver driver){
		driver.manage().timeouts().
		implicitlyWait(100, TimeUnit.SECONDS);

		ExcelUtility.setWorkSheet("HomePage");
		int rowid=1;
		try
		{
			rowid= Integer.parseInt(DriverScript.testDataID);
		}
		catch(Exception e)
		{
			rowid=1;
		}
		ExcelUtility.setRow(rowid);

		//driver.findElement(By.linkText("sign-in")).click();
		driver.findElement(By.name("userName")).sendKeys(ExcelUtility.getCellData("UserName"));
		driver.findElement(By.name("password")).sendKeys(ExcelUtility.getCellData("Password"));
		driver.findElement(By.name("login")).click();

		ReportUtility.insertStep("1", "login", "Application has been successfully signon", "Passed");

	}
}
